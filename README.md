# HeartData
心电小程序客户端数据的服务器存储和分析

# 小程序系统架构

​	小程序主要分为登陆页面、主页、心电报告页面。其中主页和心电报告页面整合为带tabbar的页面。

<img src="/./img/image-20210723183849092.png" alt="image-20210723183849092" style="zoom:30%;" />

## 登陆页面

​	用来登陆小程序。

### 页面展示

<img src="/./img/image-20210723183205703.png" alt="image-20210723183205703" style="zoom:40%" />

### 介绍

​	登陆页面由背景图片和登录按钮组成。

- 背景图片，设置铺满全屏。

- 登陆可以设置为"用户名 + 密码"形式登陆，也可以设置为微信登陆。

  目前采用微信方式登陆，点击按钮后，弹出弹窗，授权后可以获取到微信相关的信息：微信昵称、性别、地区。

  <img src="/./img/image-20210723183725257.png" alt="image-20210723183725257" style="zoom:50%;" />

### 代码框架

- js

  <img src="/./img/image-20210723184021316.png" alt="image-20210723184021316" style="zoom:30%;" />

  js部分后续还要加上将登陆信息发送到服务器部分。

  如果是微信登陆，需要在第一次登陆时发送信息。

  如果时"用户名+密码"方式登陆，则在注册时发送信息到服务器。

- wxml

  <img src="/./img/image-20210723184046722.png" alt="image-20210723184046722" style="zoom:40%;" />

## 主页

​	展示用户信息、通过蓝牙与硬件连接、实时显示波形。

### 页面展示

<img src="/./img/image-20210723184408143.png" alt="image-20210723184408143" style="zoom:40%;" />

### 介绍

​	主页由个人信息、波形区域、操作按钮和底部tabbar组成。

- 个人信息。由登陆页面传过来的参数渲染而成。这里通过微信登陆传过来的昵称、性别、城市，进行展示。
- 波形区域，用来显示心电波形。
- 操作按钮。登陆小程序进入主页后，点击按钮会弹出对话框选择蓝牙进行连接，连接完成后，开始接受数据进行波形展示。
- 底部tabbar。有两个选项卡，主页和心电报告。

### 代码框架

- js

  <img src="/./img/image-20210723203742528.png" alt="image-20210723203742528" style="zoom:40%;" />

  userInfo为用户信息；heartdata初始化为1，后面实时显示时，进行数组移动即可，更新最后一个数。

  目前缺少蓝牙部分的连接逻辑。

- wxml

  <img src="/./img/image-20210723203924092.png" alt="image-20210723203924092" style="zoom:40%;" />

## 心电报告

​	待设计...
